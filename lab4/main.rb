#!/usr/bin/env ruby

mat_event = \
[
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
    [0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
    [0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
    [0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0], \
    [0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0], \
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0], \
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0], \
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.0], \
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5], \
    [0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5]  \
]


def get_next arr
    temp = arr.clone
    summ = 0
    0.upto(temp.size - 1) do |i|
        summ += temp[i]
        temp[i] = summ
    end
    rand = Random.rand
    0.upto(temp.size - 1) do |i|
        if temp[i] >= rand
            return i
        end
    end
    temp
end

Count = 10000
a = 0
hist = {}
0.upto(9) do |i| hist[i] = 0 end
1.upto(Count) do |i|
    a = get_next(mat_event[a])
    hist[a] += 1
end
p hist
